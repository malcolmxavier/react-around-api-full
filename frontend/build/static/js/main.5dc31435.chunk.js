(this["webpackJsonpreact-around-auth"]=this["webpackJsonpreact-around-auth"]||[]).push([[0],{17:function(e,t,a){},21:function(e,t,a){e.exports=a.p+"static/media/logo.8f7611ae.svg"},26:function(e,t,a){e.exports=a(36)},36:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(19),c=a.n(o),i=(a(17),a(24)),s=a(1),l=a(2),u=a(7);var m=function(e){var t=r.a.useState(""),a=Object(s.a)(t,2),n=a[0],o=a[1],c=r.a.useState(""),i=Object(s.a)(c,2),l=i[0],m=i[1];function p(t){t.preventDefault(),e.handleSignup(n,l)}return r.a.createElement("main",{className:"content"},r.a.createElement("h2",{className:"form__name"},"Sign up"),r.a.createElement("form",{className:"form",onSubmit:p},r.a.createElement("input",{className:"form__input",type:"email",placeholder:"Email",required:!0,onChange:function(e){o(e.target.value)}}),r.a.createElement("span",{className:"form__error"}),r.a.createElement("input",{className:"form__input",type:"text",placeholder:"Password",required:!0,minlength:"8",onChange:function(e){m(e.target.value)}}),r.a.createElement("span",{className:"form__error"}),r.a.createElement("button",{className:"form__button",type:"submit","aria-label":"Sign Up",onClick:p},"Sign up")),r.a.createElement(u.b,{to:"/signin",className:"form__link"},"Already a member? Log in here!"))};var p=function(e){var t=r.a.useState(""),a=Object(s.a)(t,2),n=a[0],o=a[1],c=r.a.useState(""),i=Object(s.a)(c,2),l=i[0],m=i[1];function p(t){t.preventDefault(),e.handleLogin(n,l)}return r.a.createElement("main",{className:"content"},r.a.createElement("h2",{className:"form__name"},"Log in"),r.a.createElement("form",{className:"form",onSubmit:p},r.a.createElement("input",{className:"form__input",type:"email",placeholder:"Email",required:!0,onChange:function(e){o(e.target.value)}}),r.a.createElement("span",{className:"form__error"}),r.a.createElement("input",{className:"form__input",type:"text",placeholder:"Password",required:!0,onChange:function(e){m(e.target.value)}}),r.a.createElement("span",{className:"form__error"}),r.a.createElement("button",{className:"form__button",type:"submit","aria-label":"Log In",onClick:p},"Log in")),r.a.createElement(u.b,{to:"/signup",className:"form__link"},"Not a member yet? Sign up here!"))};var d=function(e){return r.a.createElement("div",null,r.a.createElement("section",{className:e.isOpen?"popup popup_type_".concat(e.name," popup_opened"):"popup popup_type_".concat(e.name)},r.a.createElement("div",{className:"popup__container popup__container_type_form"},r.a.createElement("button",{className:"close-button","aria-label":"Close ".concat(e.action," Popup"),onClick:e.onClose}),r.a.createElement("h2",{className:"popup__title"},e.title),r.a.createElement("form",{className:"popup__form popup__form_type_".concat(e.name),onSubmit:e.onSubmit},e.children,r.a.createElement("button",{className:"popup__button ".concat(e.button,"-button"),type:"submit","aria-label":"".concat(e.action),onClick:e.onClose})))))};var f=a(25);var h=function(e){var t=e.component,a=Object(f.a)(e,["component"]);return r.a.createElement(l.b,null,(function(){return a.isLoggedIn?r.a.createElement(t,a):r.a.createElement(l.a,{to:"/signin"})}))},_=a(21),g=a.n(_);var E=function(e){return r.a.createElement("div",{className:"Header"},r.a.createElement("header",{className:"header"},r.a.createElement("img",{src:g.a,alt:"Around The U.S. text logo",className:"logo"}),r.a.createElement(u.b,{to:e.link,className:"header__link",onClick:e.onClick},e.linkText)))},b=r.a.createContext();var v=function(e){var t=r.a.useContext(b);return r.a.createElement(b.Provider,{value:t},r.a.createElement("main",{className:"content"},r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__avatar"},r.a.createElement("img",{src:t.avatar,alt:"Profile avatar",className:"avatar avatar_profile"}),r.a.createElement("div",{className:"avatar__edit-overlay"},r.a.createElement("button",{className:"edit-button edit-button_avatar","aria-label":"Edit Avatar",onClick:e.onEditAvatar}))),r.a.createElement("div",{className:"profile__info"},r.a.createElement("h1",{className:"profile__name"},t.name),r.a.createElement("button",{className:"edit-button edit-button_profile","aria-label":"Edit Profile",onClick:e.onEditProfile}),r.a.createElement("p",{className:"profile__occupation"},t.about)),r.a.createElement("button",{className:"add-button","aria-label":"Add Card",onClick:e.onAddCard})),r.a.createElement("section",{className:"photo-grid"},r.a.createElement("ul",{className:"photo-grid__list"},e.children))))};var C=function(e){var t=r.a.useContext(b),a=e.card.owner._id===t._id,n=e.card.likes.some((function(e){return e._id===t._id}));return r.a.createElement("li",{className:"photo-grid__item",key:e.id},r.a.createElement("div",{className:"photo-grid__image",style:{backgroundImage:"url(".concat(e.image,")")},onClick:function(){e.onCard(e.image,e.title)}}),r.a.createElement("button",{className:a?"trash-button":"trash-button_hidden","aria-label":"Delete Card",onClick:e.onDeleteCard}),r.a.createElement("div",{className:"photo-grid__description"},r.a.createElement("h3",{className:"photo-grid__label"},e.title),r.a.createElement("div",{className:"photo-grid__likes"},r.a.createElement("button",{className:n?"like-button like-button_clicked":"like-button","aria-label":"Like Card",onClick:function(){e.onCardLike(e.card)}}),r.a.createElement("p",{className:"photo-grid__likes-count"},e.likesCount))))};var N=function(){return r.a.createElement("div",{className:"Footer"},r.a.createElement("footer",{className:"footer"},r.a.createElement("p",null,"\xa9 2020 Around The U.S.")))};var k=function(e){var t=r.a.useContext(b),a=r.a.useState(t.avatar),n=Object(s.a)(a,2),o=n[0],c=n[1],i=r.a.useRef(o);return r.a.createElement(d,{name:"edit-avatar",action:"Edit Avatar",title:"Change profile picture",button:"save",onClose:e.closeAllPopups,isOpen:e.isOpen,onSubmit:function(t){t.preventDefault(),e.onUpdateAvatar(o)}},r.a.createElement("input",{name:"avatar",id:"avatar-url",className:"popup__input popup__input_type_url",type:"url",placeholder:"Image URL",required:!0,ref:i,onChange:function(e){c(i.current.value)}}),r.a.createElement("span",{id:"avatar-url-error",className:"popup__error"}))};var j=function(e){var t=r.a.useContext(b),a=r.a.useState(t.name),n=Object(s.a)(a,2),o=n[0],c=n[1],i=r.a.useState(t.about),l=Object(s.a)(i,2),u=l[0],m=l[1];return r.a.useEffect((function(){c(t.name),m(t.about)}),[t]),r.a.createElement(d,{name:"edit-profile",action:"Edit Profile",title:"Edit profile",button:"save",onClose:e.onClose,isOpen:e.isOpen,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:o,about:u})}},r.a.createElement("input",{name:"userName",id:"profile-name",className:"popup__input popup__input_type_name",type:"text",placeholder:"Name",required:!0,minLength:"2",maxLength:"40",onChange:function(e){c(e.target.value)}}),r.a.createElement("span",{id:"profile-name-error",className:"popup__error"}),r.a.createElement("input",{name:"userOccupation",id:"profile-occupation",className:"popup__input popup__input_type_occupation",type:"text",placeholder:"About Me",required:!0,minLength:"2",maxLength:"200",onChange:function(e){m(e.target.value)}}),r.a.createElement("span",{id:"profile-occupation-error",className:"popup__error"}))};var y=function(e){var t=r.a.useState({}),a=Object(s.a)(t,2),n=a[0],o=a[1],c=r.a.useState({}),i=Object(s.a)(c,2),l=i[0],u=i[1];return r.a.createElement(d,{name:"add-card",action:"Add Card",title:"New Place",button:"create",onClose:e.onClose,isOpen:e.isOpen,onSubmit:function(t){t.preventDefault(),e.onAddCardSubmit({name:n,link:l})}},r.a.createElement("input",{name:"name",id:"card-label",className:"popup__input popup__input_type_label",type:"text",placeholder:"Label",required:!0,minLength:"1",maxLength:"30",onChange:function(e){o(e.target.value)}}),r.a.createElement("span",{id:"card-label-error",className:"popup__error"}),r.a.createElement("input",{name:"link",id:"card-url",className:"popup__input popup__input_type_url",type:"url",placeholder:"Image URL",required:!0,onChange:function(e){u(e.target.value)}}),r.a.createElement("span",{id:"card-url-error",className:"popup__error"}))};var S=function(e){return r.a.createElement("div",null,r.a.createElement("section",{className:e.isOpen?"popup popup_type_image popup_opened":"popup popup_type_image"},r.a.createElement("div",{className:"popup__container popup__container_type_image"},r.a.createElement("figure",{className:"figure"},r.a.createElement("button",{className:"close-button","aria-label":"Close Image Popup",onClick:e.onClose}),r.a.createElement("img",{className:"popup__image",alt:e.title,src:e.image}),r.a.createElement("figcaption",{className:"popup__caption"},e.title)))))},O="https://register.nomoreparties.co",L=a(22),x=a(23),U=new(function(){function e(t){var a=t.baseURL,n=t.headers;Object(L.a)(this,e),this._baseURL=a,this._headers=n}return Object(x.a)(e,[{key:"getUserInfo",value:function(){return fetch(this._baseURL+"/users/me",{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject(e.status+" Error: "+e.statusText)}))}},{key:"setUserInfo",value:function(e,t){return fetch(this._baseURL+"/users/me",{headers:this._headers,method:"PATCH",body:JSON.stringify({name:e,about:t})}).then((function(e){return e.ok?e.json():Promise.reject(e.status+" Error: "+e.statusText)})).catch((function(e){return console.log(e)}))}},{key:"setUserAvatar",value:function(e){return fetch(this._baseURL+"/users/me/avatar",{headers:this._headers,method:"PATCH",body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject(e.status+" Error: "+e.statusText)})).catch((function(e){return console.log(e)}))}},{key:"getCardList",value:function(){return fetch(this._baseURL+"/cards",{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject(e.status+" Error: "+e.statusText)}))}},{key:"addCard",value:function(e){var t=e.name,a=e.link;return fetch(this._baseURL+"/cards",{headers:this._headers,method:"POST",body:JSON.stringify({name:t,link:a})}).then((function(e){return e.ok?e.json():Promise.reject(e.status+" Error: "+e.statusText)})).catch((function(e){return console.log(e)}))}},{key:"removeCard",value:function(e){return fetch(this._baseURL+"/cards/"+e,{headers:this._headers,method:"DELETE"}).then((function(e){return e.ok?e.json():Promise.reject(e.status+" Error: "+e.statusText)})).catch((function(e){return console.log(e)}))}},{key:"addCardLike",value:function(e){return fetch(this._baseURL+"/cards/likes/"+e,{headers:this._headers,method:"PUT"}).then((function(e){return e.ok?e.json():Promise.reject(e.status+" Error: "+e.statusText)})).catch((function(e){return console.log(e)}))}},{key:"removeCardLike",value:function(e){return fetch(this._baseURL+"/cards/likes/"+e,{headers:this._headers,method:"DELETE"}).then((function(e){return e.ok?e.json():Promise.reject(e.status+" Error: "+e.statusText)})).catch((function(e){return console.log(e)}))}}]),e}())({baseURL:"https://register.nomoreparties.co",headers:{authorization:"bfb84dd3-54e8-4642-a5bf-7fe819e5fd4b","Content-Type":"application/json"}});var P=function(){var e=r.a.useState(!1),t=Object(s.a)(e,2),a=t[0],n=t[1],o=r.a.useState(!1),c=Object(s.a)(o,2),f=(c[0],c[1]),_=r.a.useState(!1),g=Object(s.a)(_,2),L=(g[0],g[1]),x=r.a.useState({avatar:"",name:"",about:""}),P=Object(s.a)(x,2),T=P[0],A=P[1],w=r.a.useState([]),I=Object(s.a)(w,2),R=I[0],D=I[1],q=r.a.useState(!1),J=Object(s.a)(q,2),B=J[0],H=J[1],z=r.a.useState(!1),M=Object(s.a)(z,2),W=M[0],F=M[1],G=r.a.useState(!1),$=Object(s.a)(G,2),K=$[0],Q=$[1],V=r.a.useState(!1),X=Object(s.a)(V,2),Y=X[0],Z=X[1],ee=r.a.useState(!1),te=Object(s.a)(ee,2),ae=te[0],ne=te[1],re=r.a.useState(""),oe=Object(s.a)(re,2),ce=oe[0],ie=oe[1],se=r.a.useState(""),le=Object(s.a)(se,2),ue=le[0],me=le[1],pe=Object(l.g)();function de(e){e.likes.some((function(e){return e._id===T._id}))?U.removeCardLike(e._id).then((function(t){var a=R.map((function(a){return a._id===e._id?t:a}));D(a)})).catch((function(e){return console.log(e)})):U.addCardLike(e._id).then((function(t){var a=R.map((function(a){return a._id===e._id?t:a}));D(a)})).catch((function(e){return console.log(e)}))}function fe(e,t){ne(!0),ie(e),me(t)}function he(){Z(!0)}function _e(){f(!1),H(!1),F(!1),Q(!1),Z(!1),ne(!1)}return r.a.useEffect((function(){var e,t=localStorage.getItem("jwt");t&&(e=t,fetch("".concat(O,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){return e}))).then((function(e){var t={username:e.username,email:e.email};n(!0),L(t),pe.push("/")}))}),[pe,a]),r.a.useEffect((function(){U.getCardList().then((function(e){D(e)})).catch((function(e){return console.log(e)}))}),[D,R]),r.a.useEffect((function(){U.getUserInfo().then((function(e){A(e)})).catch((function(e){return console.log(e)}))}),[A]),r.a.createElement(b.Provider,{value:T},r.a.createElement("div",{className:"page"},r.a.createElement(u.a,null,r.a.createElement(l.d,null,r.a.createElement(l.b,{path:"/signup"},r.a.createElement(E,{link:"/signin",linkText:"Log in"}),r.a.createElement(m,{handleSignup:function(e,t){(function(e,t){return fetch("".concat(O,"/auth/local/register"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.log(e)}))})(e,t).then((function(e){if(!e||400===e.statusCode)throw f(!0),new Error("Something is not right.");return e})).then((function(){f(!0),pe.push("/signin")})).catch((function(e){return console.log(e)}))}})),r.a.createElement(l.b,{path:"/signin"},r.a.createElement(E,{link:"/signup",linkText:"Sign up"}),r.a.createElement(p,{handleLogin:function(e,t){e&&t&&function(e,t){return fetch("".concat(O,"/auth/local"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.json()})).then((function(e){return e.user?(localStorage.setItem("jwt",e.jwt),e):void 0})).catch((function(e){return console.log(e)}))}(e,t).then((function(e){if(!e)throw new Error("Something is not right.")})).then((function(){return pe.push("/")})).catch((function(e){return console.log(e)}))}})),r.a.createElement(h,{exact:!0,path:"/",isLoggedIn:a,component:v}),r.a.createElement(E,{link:"/signin",linkText:"Sign Out",onClick:function(){localStorage.removeItem("jwt"),n(!1),pe.push("/signin")}}),r.a.createElement(v,{onEditAvatar:function(){H(!0)},onEditProfile:function(){F(!0)},onAddCard:function(){Q(!0)}},R.map((function(e){return r.a.createElement(C,{card:e,key:e._id,id:e._id,image:e.link,title:e.name,likesCount:e.likes.length,onCardLike:de,onDeleteCard:he,onCard:fe})}))),r.a.createElement(k,{isOpen:B,onClose:_e,onUpdateAvatar:function(e){U.setUserAvatar(e).then(A({avatar:e,name:T.name,about:T.about})).then(_e()).catch((function(e){return console.log(e)}))}}),r.a.createElement(j,{isOpen:W,onClose:_e,onUpdateUser:function(e){var t=e.name,a=e.about;U.setUserInfo(t,a).then(A({avatar:T.avatar,name:t,about:a})).then(_e()).catch((function(e){return console.log(e)}))}}),r.a.createElement(y,{isOpen:K,onClose:_e,onAddCardSubmit:function(e){var t=e.name,a=e.link;U.addCard({name:t,link:a}).then((function(e){D([].concat(Object(i.a)(R),[e]))})).then(_e()).catch((function(e){return console.log(e)}))}}),r.a.createElement(S,{image:ce,title:ue,onClose:_e,isOpen:ae}),r.a.createElement(d,{name:"delete-card",action:"Delete Card",title:"Are you sure?",button:"yes",onClose:_e,isOpen:Y,onSubmit:function(e){U.removeCard(e._id).then((function(t){var a=R.filter((function(t){return t._id!==e._id}));D(a)})).catch((function(e){return console.log(e)}))}}),r.a.createElement(N,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[26,1,2]]]);
//# sourceMappingURL=main.5dc31435.chunk.js.map